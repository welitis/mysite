{% extends 'base.html' %}
{% load static %}
{% block title %}注册{% endblock %}

{% block css %}<link rel="stylesheet" href="{% static 'css/login.css'%}" type="text/css">{% endblock %}

{% block content %}

    <form action="{% url 'login:register' %}" method="post" class="form-login">
    {% if message %}
        <div class="alert-warning alert">{{ message }}</div>
    {% endif %}
    {% csrf_token %}
    <h2 class="text-center">欢迎注册</h2>
    <div class="form-group">
        {{ register_form.name.label_tag }}
        {{ register_form.name }}
    </div>
    <div class="form-group">
        {{ register_form.password1.label_tag }}
        {{ register_form.password1 }}
    </div>
    <div class="form-group">
        {{ register_form.password2.label_tag }}
        {{ register_form.password2 }}
    </div>
    <div class="form-group">
        {{ register_form.email.label_tag }}
        {{ register_form.email }}
    </div>
    <div class="form-group">
        {{ register_form.sex.label_tag }}
        {{ register_form.sex }}
    </div>
    <div class="form-group">
        {{ register_form.captcha.errors }}
        {{ register_form.captcha.label_tag }}
        {{ register_form.captcha }}
    </div>
        <input type="reset" class="btn btn-default pull-left" value="重置">
        <input type="submit" class="btn btn-primary pull-right" value="登录">
    </form>
{% endblock %}

{% block js %}
    <script>
    $(function(){
        $('.captcha').click(function(){
            console.log('click');
            $.getJSON("/captcha/refresh/", function (result) {
                $('.captcha').attr('src', result['image_url']);
                $('#id_captcha_0').val(result['key'])
            })
        })
    })
</script>
{% endblock %}